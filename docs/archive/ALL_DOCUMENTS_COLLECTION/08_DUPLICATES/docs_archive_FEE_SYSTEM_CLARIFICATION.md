# 수수료 시스템 명확화 - 2025년 7월 5일

## 중요: 수수료 시스템의 실제 비즈니스 로직

### 이전 오해
- 기존에는 TRON의 Energy/Bandwidth 모델과 맞지 않다고 판단
- 정적 수수료 시스템이 잘못되었다고 생각

### 실제 비즈니스 모델 (사용자 설명 - 2025.07.05)

#### 1. 플랫폼 에너지 스폰서십 구조
```
TRON 네트워크 레벨:
- 본사가 TRX를 freeze하여 Energy Pool 운영
- 사용자의 모든 트랜잭션을 본사가 에너지로 대신 지불
- 사용자는 실제 TRON 수수료(Energy/Bandwidth)를 직접 지불하지 않음
```

#### 2. 플랫폼 서비스 수수료
```
플랫폼 레벨:
- 사용자가 외부 출금 시 플랫폼 서비스 수수료 지불
- 기본: 1 USDT (또는 관리자가 설정한 금액)
- 이 수수료는 사용자 지갑 → 본사 지갑으로 이동
- 내부 거래 시에는 적용되지 않음 (DB상 숫자 이동만)
```

#### 3. 트랜잭션 플로우

**외부 출금 시:**
1. 사용자가 10 USDT 출금 요청
2. 플랫폼 서비스 수수료 1 USDT 차감 (사용자 → 본사)
3. 본사가 에너지로 TRON 네트워크 수수료 지불
4. 실제로 외부 주소로 10 USDT 전송
5. 총 사용자 차감: 11 USDT (10 + 1)

**내부 거래 시:**
1. 사용자 A → 사용자 B로 10 USDT 전송
2. DB상에서만 잔고 이동
3. 수수료 없음 (또는 최소한의 내부 수수료)

#### 4. 수수료 설정 구조
```python
# 현재 FeeConfig 모델이 올바른 구조
class FeeConfig:
    fee_type: str        # "withdrawal", "internal_transfer" 등
    asset: str           # "USDT", "TRX"
    fee_amount: Decimal  # 1.0 USDT (플랫폼 서비스 수수료)
    # 이는 TRON 네트워크 수수료가 아닌 플랫폼 서비스 수수료
```

### 결론

**현재 수수료 시스템은 올바르게 구현되어 있음:**
- TRON Energy는 본사가 스폰서십으로 제공
- 플랫폼 서비스 수수료는 별도로 사용자에게 부과
- 이는 일반적인 거래소/지갑 서비스의 표준 모델

**다음 작업:**
- 현재 FeeConfig 시스템 유지
- 관리자 대시보드에서 수수료 설정 기능 완성
- Energy Pool 모니터링 기능 추가 (본사 에너지 관리용)
- 내부/외부 거래 구분 로직 명확화

### 오해 정정
이전에 "수수료 시스템이 잘못되었다"고 판단한 것은 오해였음. 
실제로는 TRON Energy 스폰서십 + 플랫폼 서비스 수수료의 하이브리드 모델이 올바른 구조.
